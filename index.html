<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Misi√≥n Caos: Familia</title>
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Roboto:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --edu-color: #00d2ff;  /* Azul Ne√≥n */
            --dani-color: #ff0099; /* Rosa Ne√≥n */
            --vicky-color: #ffee00;/* Amarillo Ne√≥n */
            --bg-dark: #0a0a0a;
            --panel-bg: #1a1a1a;
        }

        * { box-sizing: border-box; touch-action: manipulation; }

        body {
            margin: 0; padding: 0;
            background-color: var(--bg-dark);
            color: white;
            font-family: 'Roboto', sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- PANTALLAS --- */
        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: radial-gradient(circle, #1a1a1a 0%, #000000 100%);
            transition: opacity 0.5s;
            padding: 20px; text-align: center;
        }
        .hidden { opacity: 0; pointer-events: none; z-index: -1; }
        .active { opacity: 1; pointer-events: all; z-index: 10; }

        /* --- TIPOGRAF√çA --- */
        h1 {
            font-family: 'Black Ops One', cursive;
            font-size: 3rem; margin: 0;
            text-transform: uppercase;
            background: linear-gradient(to right, #ff0099, #00d2ff, #ffee00);
            -webkit-background-clip: text;
            color: transparent;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.3));
            animation: pulseTitle 2s infinite;
        }

        .player-name {
            font-family: 'Black Ops One', cursive;
            font-size: 4rem; margin: 10px 0;
            text-shadow: 0 0 20px currentColor;
        }

        .task-text {
            font-size: 1.8rem; font-weight: 900;
            margin: 20px 0; line-height: 1.2;
            color: #fff;
        }

        /* --- TEMPORIZADOR --- */
        #timer-display {
            font-family: 'Black Ops One', cursive;
            font-size: 6rem;
            color: #ff3333;
            text-shadow: 0 0 30px #ff0000;
            margin: 10px 0;
        }
        .timer-warning { animation: shake 0.5s infinite; color: #ff0000 !important; }

        /* --- BOTONES --- */
        .btn-big {
            background: transparent;
            border: 4px solid white;
            color: white;
            font-family: 'Black Ops One', cursive;
            font-size: 2rem;
            padding: 20px 40px;
            border-radius: 20px;
            margin-top: 20px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
            transition: transform 0.1s;
            width: 100%; max-width: 300px;
        }
        .btn-big:active { transform: scale(0.95); }

        .btn-success { border-color: #39ff14; color: #39ff14; box-shadow: 0 0 20px #39ff14; }
        .btn-fail { border-color: #ff0055; color: #ff0055; box-shadow: 0 0 20px #ff0055; }

        /* --- MARCADOR --- */
        #scoreboard {
            position: absolute; top: 0; left: 0; width: 100%;
            display: flex; justify-content: space-around;
            padding: 10px; background: rgba(255,255,255,0.05);
            backdrop-filter: blur(5px);
            z-index: 100;
        }
        .score-box { text-align: center; font-weight: bold; }
        .score-box span { display: block; font-size: 1.5rem; font-family: 'Black Ops One'; }
        
        /* --- ANIMACIONES --- */
        @keyframes pulseTitle { 0%,100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 20% { transform: translate(-3px, 0px) rotate(1deg); } 30% { transform: translate(3px, 2px) rotate(0deg); } 40% { transform: translate(1px, -1px) rotate(1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 60% { transform: translate(-3px, 1px) rotate(0deg); } 70% { transform: translate(3px, 1px) rotate(-1deg); } 80% { transform: translate(-1px, -1px) rotate(1deg); } 90% { transform: translate(1px, 2px) rotate(0deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }

    </style>
</head>
<body>

    <div id="scoreboard">
        <div class="score-box" style="color: var(--edu-color)">EDU<br><span id="score-edu">0</span></div>
        <div class="score-box" style="color: var(--vicky-color)">VICKY<br><span id="score-vicky">0</span></div>
        <div class="score-box" style="color: var(--dani-color)">DANI<br><span id="score-dani">0</span></div>
    </div>

    <div id="screen-start" class="screen active">
        <h1>MISI√ìN<br>CAOS</h1>
        <p style="font-size: 1.2rem; color: #aaa;">Edici√≥n Familia</p>
        <div style="font-size: 4rem; margin: 20px;">üë®‚Äçüë©‚Äçüëß</div>
        <button class="btn-big" onclick="initGame()">¬°ESTAMOS LISTOS!</button>
    </div>

    <div id="screen-roulette" class="screen hidden">
        <h2 style="color:white;">EL TURNO ES DE...</h2>
        <div id="roulette-name" class="player-name" style="color: white;">...</div>
    </div>

    <div id="screen-mission" class="screen hidden">
        <div id="mission-player" class="player-name">EDU</div>
        <div style="font-size: 1.2rem; color:#aaa; text-transform: uppercase;">Tu Misi√≥n es:</div>
        <div id="mission-text" class="task-text">Correr al ba√±o y traer papel</div>
        
        <div id="timer-display">30</div>

        <div id="action-buttons" style="display:none; width: 100%; display: flex; flex-direction: column; align-items: center;">
            <button class="btn-big btn-success" onclick="missionResult(true)">¬°LOGRADO! üòé</button>
            <button class="btn-big btn-fail" onclick="missionResult(false)">FALL√â üò≠</button>
        </div>
    </div>

    <script>
        // --- CONFIGURACI√ìN DE PRENDAS ---
        const players = {
            'Edu': {
                color: 'var(--edu-color)',
                tasks: [
                    { t: "¬°Trae un rollo de papel higi√©nico del ba√±o!", time: 25 },
                    { t: "¬°T√≠rate al piso y haz 10 abdominales!", time: 30 },
                    { t: "¬°Haz 10 flexiones de brazos!", time: 30 },
                    { t: "Trae un tenedor de la cocina.", time: 20 },
                    { t: "¬°Baila 'Robot' sin m√∫sica!", time: 15 },
                    { t: "Haz la plancha (plank) sin moverte.", time: 20 },
                    { t: "¬°Trae un zapato tuyo!", time: 20 },
                    { t: "Imita a un gorila enojado.", time: 15 }
                ]
            },
            'Dani': {
                color: 'var(--dani-color)',
                tasks: [
                    { t: "¬°Trae una almohada del cuarto!", time: 25 },
                    { t: "¬°Haz 15 sentadillas r√°pido!", time: 30 },
                    { t: "Trae algo de color ROJO.", time: 20 },
                    { t: "¬°Canta una canci√≥n de Disney a los gritos!", time: 20 },
                    { t: "Haz el 'puente' en el piso.", time: 20 },
                    { t: "Trae un vaso con agua (sin tirar).", time: 30 },
                    { t: "Camina como una modelo por la sala.", time: 15 },
                    { t: "¬°Salta 10 veces con las rodillas al pecho!", time: 20 }
                ]
            },
            'Vicky': {
                color: 'var(--vicky-color)',
                tasks: [
                    { t: "¬°Corre y abraza a Mam√°!", time: 10 },
                    { t: "¬°Corre y abraza a Pap√°!", time: 10 },
                    { t: "¬°Trae tu juguete favorito!", time: 30 },
                    { t: "Salta en un pie 5 veces.", time: 15 },
                    { t: "Gira como un trompo 3 veces.", time: 10 },
                    { t: "Haz una mueca muy graciosa.", time: 10 },
                    { t: "Camina como un zombie.", time: 15 },
                    { t: "Toca el piso y salta al cielo 5 veces.", time: 20 },
                    { t: "¬°Hazte la dormida en el piso!", time: 10 }
                ]
            }
        };

        const scores = { 'Edu': 0, 'Dani': 0, 'Vicky': 0 };
        let currentPlayer = '';
        let timerInterval;
        let audioCtx;

        // --- SISTEMA DE AUDIO ---
        function initAudio() {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }

        function playTone(type) {
            if (!audioCtx) return;
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if(type === 'tick') {
                osc.type = 'square';
                osc.frequency.setValueAtTime(800, now);
                gain.gain.setValueAtTime(0.1, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                osc.start(now); osc.stop(now + 0.1);
            } else if (type === 'alarm') {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(600, now);
                osc.frequency.linearRampToValueAtTime(100, now + 0.5);
                gain.gain.setValueAtTime(0.5, now);
                gain.gain.linearRampToValueAtTime(0, now + 0.5);
                osc.start(now); osc.stop(now + 0.5);
            } else if (type === 'win') {
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(440, now); // A4
                osc.frequency.setValueAtTime(880, now + 0.1); // A5
                gain.gain.setValueAtTime(0.1, now);
                gain.gain.linearRampToValueAtTime(0, now + 0.5);
                osc.start(now); osc.stop(now + 0.5);
            } else if (type === 'spin') {
                 osc.type = 'sine';
                 osc.frequency.value = 200 + Math.random()*500;
                 gain.gain.setValueAtTime(0.1, now);
                 gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                 osc.start(now); osc.stop(now + 0.1);
            }
        }

        // --- L√ìGICA DEL JUEGO ---
        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => {
                s.classList.remove('active');
                s.classList.add('hidden');
            });
            document.getElementById(id).classList.remove('hidden');
            document.getElementById(id).classList.add('active');
        }

        function initGame() {
            initAudio();
            spinRoulette();
        }

        function spinRoulette() {
            showScreen('screen-roulette');
            const names = ['Edu', 'Dani', 'Vicky'];
            const el = document.getElementById('roulette-name');
            let counter = 0;
            let maxSpins = 20;
            
            const interval = setInterval(() => {
                playTone('spin');
                const randomName = names[Math.floor(Math.random() * names.length)];
                el.innerText = randomName;
                el.style.color = players[randomName].color;
                counter++;
                if (counter > maxSpins) {
                    clearInterval(interval);
                    currentPlayer = randomName;
                    setTimeout(startMission, 1000);
                }
            }, 100);
        }

        function startMission() {
            const pData = players[currentPlayer];
            const taskObj = pData.tasks[Math.floor(Math.random() * pData.tasks.length)];
            
            document.getElementById('mission-player').innerText = currentPlayer;
            document.getElementById('mission-player').style.color = pData.color;
            document.getElementById('mission-text').innerText = taskObj.t;
            
            showScreen('screen-mission');
            
            // Iniciar Timer
            let timeLeft = taskObj.time;
            const timerEl = document.getElementById('timer-display');
            const btns = document.getElementById('action-buttons');
            
            timerEl.innerText = timeLeft;
            timerEl.classList.remove('timer-warning');
            btns.style.display = 'flex'; // Mostrar botones

            if(timerInterval) clearInterval(timerInterval);

            timerInterval = setInterval(() => {
                timeLeft--;
                timerEl.innerText = timeLeft;
                playTone('tick');

                if (timeLeft <= 5) {
                    timerEl.classList.add('timer-warning');
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerEl.innerText = "¬°BOOM!";
                    playTone('alarm');
                    // Vibrar si es celular
                    if(navigator.vibrate) navigator.vibrate(500);
                }
            }, 1000);
        }

        function missionResult(success) {
            clearInterval(timerInterval);
            if (success) {
                playTone('win');
                scores[currentPlayer] += 100; // 100 puntos por ganar
                document.getElementById(`score-${currentPlayer.toLowerCase()}`).innerText = scores[currentPlayer];
            } else {
                playTone('alarm');
            }
            
            setTimeout(spinRoulette, 1000); // Volver a girar
        }

    </script>
</body>
</html>